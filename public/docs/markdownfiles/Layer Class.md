# Layer 클래스

`Layer` 클래스는 **AI 프레임워크의 기본적인 추상화 클래스**로, 모든 딥러닝 레이어의 **기본 구조와 동작을 정의**합니다. 이 클래스는 다양한 신경망 레이어(`Dense`, `Conv2D`, `LSTM` 등)를 구현할 때 공통적으로 필요한 기능을 제공하며, **상속**을 통해 쉽게 확장할 수 있도록 설계되었습니다.

---

## **주요 속성 및 메서드 설명**

### **1. 주요 속성 (Attributes)**

- **`name`**:
    - 레이어의 이름을 지정하는 속성입니다. 사용자가 이름을 지정하지 않으면, 클래스의 이름(`__class__.__name__`)이 기본값으로 설정됩니다.
    - 예: `'Dense'`, `'Conv2D'`, `'LSTM'` 등.
- **`input_shape`**:
    - 입력 데이터의 형태를 정의하는 속성입니다. `build()` 메서드에서 설정되며, 이후 레이어의 Forward 연산에서 사용됩니다.
- **`output_shape`**:
    - 출력 데이터의 형태를 정의하는 속성입니다. 주로 레이어의 Forward 연산 후 설정됩니다.
- **`built`**:
    - 레이어가 **초기화(build)**되었는지를 나타내는 플래그입니다. `build()` 메서드가 호출되면 `True`로 설정되며, 이를 통해 연산이 올바르게 수행되는지 확인할 수 있습니다.
- **`regularizer`**:
    - *정규화 기법(Regularizer)**을 적용할 때 사용됩니다. `regularizers.get()` 메서드를 통해 설정되며, 가중치에 L1, L2 등 다양한 정규화 기법을 적용할 수 있습니다.

---

### **2. 주요 메서드 (Methods)**

### **`__init__(self, name=None, regularizer=None, **kwargs)`**

- 레이어의 초기화 메서드입니다. 다음과 같은 인자를 받습니다:
    - **`name`**: 레이어의 이름.
    - **`regularizer`**: 정규화 기법(L1, L2 등).
    - **`kwargs`**: 기타 추가 인자(예: `input_dim`).
- **Regularizer 설정**: `regularizers.get()` 메서드를 통해 정규화 객체를 가져옵니다. 만약 `regularizer` 인자가 제공되지 않으면, `self.regularizer`는 `None`으로 설정됩니다.

### **`build(self, input_shape=None)`**

- 레이어의 **초기화 작업**을 수행하는 메서드입니다.
- **`input_shape` 인자**가 제공되지 않으면, 초기화 시 전달된 `input_dim` 값을 사용합니다.
- 이 메서드가 호출되면, `self.built` 속성이 `True`로 설정됩니다.
- **예외 처리**:
    - `input_shape`가 제공되지 않으면, `ValueError`를 발생시킵니다.

### **`call(self, *args, **kwargs)`**

- 레이어의 **Forward 연산**을 수행하는 메서드입니다. 이 메서드는 반드시 **상속받는 클래스에서 구현**해야 합니다.
- **예외 처리**:
    - 레이어가 빌드되지 않았을 경우, `RuntimeError`를 발생시킵니다.
    - 메서드가 구현되지 않았을 경우, `NotImplementedError`를 발생시킵니다.
- **확장 가능성**:
    - 사용자 정의 레이어는 이 메서드를 구현하여, 원하는 연산을 정의할 수 있습니다.

### **`apply_regularizer(self, weights)`**

- **가중치에 대해 정규화(Regularization)를 적용**하는 메서드입니다.
- **Regularizer 객체**가 설정된 경우, 가중치에 대해 정규화 값을 반환합니다.
- 만약 `self.regularizer`가 `None`이라면, `0`을 반환합니다.
- 이 메서드는 역전파 과정에서 **손실 함수의 추가 항**으로 사용됩니다.

### **`get_config(self)`**

- 레이어의 **구성 정보(Config)**를 딕셔너리 형태로 반환하는 메서드입니다.
- 반환되는 구성 정보는 다음과 같습니다:
    - `'name'`: 레이어 이름
    - `'input_shape'`: 입력 데이터 형태
    - `'output_shape'`: 출력 데이터 형태
    - `'regularizer'`: 정규화 기법의 이름 (없을 경우 `None`)
    - `'module'`: 레이어가 포함된 모듈(`"dev.layers"`)

### **`from_config(cls, config)`**

- **구성 정보를 사용해 인스턴스를 복원**하는 클래스 메서드입니다.
- 주어진 `config` 딕셔너리를 사용하여 새로운 인스턴스를 생성하고, 입력/출력 형태 및 Regularizer 설정을 복원합니다.

---

## **Layer 클래스의 설계 철학 및 확장성**

- **추상화와 일관성**:
    - `Layer` 클래스는 모든 레이어의 **공통 기능을 정의**하고, 공통된 인터페이스(`call`, `build`, `get_config`)를 제공합니다.
    - 이를 통해 다양한 레이어(`Dense`, `Conv2D`, `LSTM` 등)가 **일관된 구조**로 구현될 수 있습니다.
- **커스터마이징 가능성**:
    - 사용자는 `Layer` 클래스를 상속받아, **사용자 정의 레이어**를 쉽게 구현할 수 있습니다.
    - 예를 들어, 새로운 활성화 함수나 복잡한 연산을 포함한 레이어를 정의할 때, `call()` 메서드를 재정의하면 됩니다.
- **Regularizer의 유연한 적용**:
    - Regularizer는 문자열(`'l1'`, `'l2'`) 또는 직접 정의된 Regularizer 객체로 설정할 수 있습니다.
    - 이를 통해 사용자는 다양한 정규화 기법을 쉽게 적용할 수 있으며, 과적합(Overfitting)을 방지할 수 있습니다.

[Layer Class Code](Layer%20Class%20Code%2013ce8eae9629802b8506f45a6ce2ab70.md)