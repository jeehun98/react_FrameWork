# Dense 클래스

**Dense** 클래스는 **Fully Connected Layer (완전 연결 레이어)**로, 신경망의 기본적인 연산을 수행하는 레이어입니다. 입력 데이터와 가중치 간의 **행렬 곱셈**, **편향 추가**, **활성화 함수 적용**을 통해 출력값을 계산합니다. 이 클래스는 다양한 가중치 초기화 방식과 활성화 함수를 지원하며, 상속받은 `Layer` 클래스를 확장하여 구현되었습니다.

---

## **클래스 개요**

- **상속**: `Dense` 클래스는 `Layer` 클래스를 상속받아, 딥러닝 모델에서 기본적인 레이어로 사용됩니다.
- **주요 기능**:
    - **가중치 초기화**: 다양한 초기화 방법(`he`, `xavier`, `zeros`, `ones`, `random_uniform`)을 지원합니다.
    - **활성화 함수 적용**: 다양한 활성화 함수를 사용할 수 있습니다.
    - **Forward 연산**: 입력 데이터에 대해 행렬 곱셈, 편향 추가, 활성화 함수 적용을 수행합니다.

---

## **주요 속성 (Attributes)**

- **`units`**:
    - 레이어의 출력 유닛 개수입니다. 모델의 출력 차원을 정의합니다.
- **`activation`**:
    - 활성화 함수입니다. `activations.get()`을 통해 문자열로 전달된 활성화 함수를 가져옵니다.
    - 활성화 함수가 지정되지 않은 경우(`None`), 활성화 함수가 적용되지 않습니다.
- **`initializer`**:
    - 가중치 초기화 방법입니다. 다양한 초기화 방식(`he`, `xavier`, `zeros`, `ones`, `random_uniform`)을 지원합니다.
    - 초기화 방식은 `initialize_weights()` 메서드에서 정의됩니다.
- **`weights`, `bias`**:
    - 가중치(`weights`): 입력과 출력 간의 행렬 곱셈에서 사용되는 가중치 행렬입니다.
    - 편향(`bias`): 출력값에 추가되는 편향 벡터입니다.
- **`node_list`**, **`mul_mat_node_list`**, **`add_bias_node_list`**, **`act_node_list`**:
    - 계산 그래프에서 사용되는 노드들의 리스트입니다.
    - `node_list`는 최종 출력 노드 리스트이며, 각각의 연산 단계에서 생성된 노드들을 저장합니다.

---

## **메서드 설명 (Methods)**

### **`__init__(self, units, activation=None, name=None, initializer='he', **kwargs)`**

- **설명**: 클래스 초기화 메서드로, 레이어의 유닛 개수, 활성화 함수, 가중치 초기화 방법 등을 설정합니다.
- **인자**:
    - `units`: 출력 유닛의 개수.
    - `activation`: 활성화 함수(`relu`, `sigmoid`, `tanh` 등).
    - `initializer`: 가중치 초기화 방법(`he`, `xavier`, `zeros` 등).
    - `name`: 레이어의 이름.
- **기본값**: 활성화 함수는 `None`, 초기화 방법은 `'he'`입니다.

---

### **`initialize_weights(self, input_dim)`**

- **설명**: 입력 차원(`input_dim`)에 따라 가중치와 편향을 초기화합니다.
- **초기화 방법**:
    - **He 초기화**: `np.sqrt(2 / input_dim)`로 스케일링.
    - **Xavier 초기화**: `np.sqrt(1 / input_dim)`로 스케일링.
    - **Zeros 초기화**: 모든 가중치가 0으로 설정됨.
    - **Ones 초기화**: 모든 가중치가 1로 설정됨.
    - **Random Uniform 초기화**: `[-0.05, 0.05]` 범위에서 무작위로 초기화.
- **예외 처리**: 알려지지 않은 초기화 방법이 전달되면 `ValueError`를 발생시킵니다.

---

### **`build(self, input_shape)`**

- **설명**: 레이어의 가중치를 초기화하고, 입력 형태(`input_shape`)를 설정합니다.
- **인자**:
    - `input_shape`: 입력 데이터의 형태 `(batch_size, input_dim)`을 포함하는 튜플입니다.
- **예외 처리**: 입력 형태가 올바르지 않을 경우 `ValueError`를 발생시킵니다.
- **동작**:
    - 입력 차원의 정보(`input_dim`)를 추출하고, `initialize_weights()`를 호출하여 가중치와 편향을 초기화합니다.
    - `super().build()`를 호출하여 상위 클래스의 `build()` 메서드를 실행합니다.

---

### **`call(self, input_data)`**

- **설명**: Forward 연산을 수행하는 메서드로, 입력 데이터에 대해 가중치 연산, 편향 추가, 활성화 함수 적용을 수행합니다.
- **인자**:
    - `input_data`: 입력 데이터, `(batch_size, input_dim)` 형태의 2차원 배열입니다.
- **동작**:
    1. **행렬 곱셈**: 입력 데이터와 가중치의 행렬 곱셈을 수행 (`matrix_multiply`).
    2. **편향 추가**: 편향 벡터(`bias`)를 출력값에 추가 (`matrix_add`).
    3. **활성화 함수 적용**: 활성화 함수가 지정된 경우 출력값에 적용.
- **반환값**: 최종 출력값 `(batch_size, units)` 형태의 배열입니다.
- **예외 처리**: 입력 데이터의 차원이 예상과 다를 경우 `ValueError`를 발생시킵니다.

---

### **`get_config(self)`**

- **설명**: 레이어의 구성 정보를 반환하는 메서드입니다.
- **반환값**: 구성 정보를 포함하는 딕셔너리.
- **구성 정보**:
    - `'class_name'`: 클래스 이름.
    - `'units'`: 출력 유닛의 개수.
    - `'activation'`: 활성화 함수 이름.
    - `'initializer'`: 가중치 초기화 방법.
    - `'input_shape'`: 입력 형태.
    - `'trainable'`: 가중치 갱신 여부.

---

### **`from_config(cls, config)`**

- **설명**: 구성 정보를 사용해 인스턴스를 생성하는 클래스 메서드입니다.
- **인자**:
    - `config`: `get_config()` 메서드에서 반환된 구성 정보 딕셔너리입니다.
- **반환값**: 새롭게 생성된 `Dense` 인스턴스.

---

### **`set_root_node(self)`**

- **설명**: 계산 그래프에서 모든 노드의 루트를 설정합니다.
- **동작**:
    - 각 노드의 루트를 찾고, `node_list`를 업데이트합니다.
    - 중복 작업을 피하기 위해, 루트 노드가 이미 설정된 경우 이를 건너뜁니다.

[Dense Class Code](Dense%20Class%20Code%2013ce8eae962980779888da7f6945e4f2.md)